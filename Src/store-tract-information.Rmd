---
title: "Store tract information"
author: "Satya Golla and Steve Simon"
date: "Created 2022-03-14"
output: html_document
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding,
  output_dir = "../results", output_format = "all") })  
---


```{r setup}
library(sf)
library(tidyverse)
```

### Census tracts

A Census tract is a region usually within a single county that contains roughly 4,000 people. There are files for census tracts for [Kansas][c_tract_ks] and [Missouri][c_tract_mo].  The various functions described in the US counties shapefiles section will be used here.
demo


```{r read-tract-ks}
path_name <- "../data"
file_name <- "tr/tl_2021_20_tract.shp"
path_name                              %>%
  paste(file_name, sep="/")            %>%
  st_read(stringsAsFactors=FALSE)      -> all_tract_ks
head(all_tract_ks)
all_tract_ks                           %>%
     ggplot()                              +
      geom_sf(aes())                    +
      ggtitle("ks-tract")
```


```{r read-tract-mo}
path_name <- "../data"
file_name <- "tr/tl_2021_29_tract.shp"
path_name                              %>%
  paste(file_name, sep="/")            %>%
  st_read(stringsAsFactors=FALSE)      -> all_tract_mo
head(all_tract_mo)
all_tract_mo                           %>%
     ggplot()                              +
      geom_sf(aes())                    +
      ggtitle("mo-tract")
```


```{r combine-tracts} 
all_tract_ks                           %>%
  bind_rows(all_tract_mo)  -> tr
tr                                     %>%
 ggplot()                               +
      geom_sf(aes())                    +
      ggtitle("mo-ks-tracts")  
```

variable in the file 

+ Variables:
  +   "STATEFP10"
  +   "PUMACE10"
  +   "GEOID10"
  +   "NAMELSAD10"
  +   "MTFCC10" 
  +   "FUNCSTAT10" 
  +   "ALAND10"
  +   "AWATER10"
  +   "INTPTLAT10"
  +   "INTPTLON10"
  +   "geometry"
  
### Rename variables

```{r rename}
tr                                     %>%
  mutate(tr_id=GEOID)                  %>%
  rename(tr_name=NAMELSAD)             %>%
  mutate(
    tr_area=
      as.numeric(st_area(tr)))         %>%
  select(
    tr_id,
    tr_name,
    tr_area,
    geometry)                           -> tr
glimpse(tr)
```

### Store as RData

```{r save}
save(tr, file="../data/tr.RData")
```
