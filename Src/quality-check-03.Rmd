---
title: "Quality check 03, Block group intersections with community districts"
author: "Satya Golla and Steve Simon"
date: "Created 2022-03-21"
output: html_document
---

This program examines tracts that only partially intersect with community districts.

### Load relevant files

```{r setup}
library(sf)
library(tidyverse)
library(magrittr)
path_name <- "../data/"
load(paste0(path_name, "bl", ".RData"))
glimpse(bl)
load(paste0(path_name, "cd", ".RData"))
glimpse(cd)
load(paste0(path_name, "icd", ".RData"))
glimpse(icd)
load(paste0(path_name, "red", ".RData"))
glimpse(red)
load(paste0(path_name, "bg", ".RData"))
glimpse(bg)
```

### Find community ids

```{r find}
icd                                    %>%
  tibble                               %>%
  distinct(cd_id)                      %>%
  arrange(cd_id)                       %>%
  pull(cd_id)                           -> cd_list
for (i in cd_list) {
  icd                                  %>%
    filter(cd_id==i)                   %>%
    tibble                             %>%
    distinct(bg_id)                    %>%
    arrange(bg_id)                     %>%
    pull(bg_id)                         -> bg_list
  print(
    paste(
      i, 
      paste(
        bg_list, 
        collapse=", "), 
      sep=": "))
  cd                                   %>%
    filter(cd_id==i)                    -> cd_i
  bg                                   %>%
    filter(bg_id %in% bg_list)          -> bg_i
  for (j in bg_list) {
    bg_i %>% filter(bg_id==j) -> bg_j
    ggplot(bg_i, aes())                   +
      geom_sf(
        fill=NA, 
        color="lightgreen")                +
      geom_sf(
        data=cd_i,
        aes(),
        fill="white",
        color="darkred")                   +
      geom_sf(
        data=bg_j, 
        aes(),
        fill="NA",
        color="darkgreen")                 -> map1
    plot(map1)  
  }
}
```


<!---Key census links go here--->
